!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Cog=t():e.Cog=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,c=void 0,c=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===n(c)?c:String(c)),o)}var i,c}function o(e){var t=a();return function(){var r,o=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function i(e){var t="function"==typeof Map?new Map:void 0;return i=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return c(e,arguments,l(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),u(n,e)},i(e)}function c(e,t,n){return c=a()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&u(o,n.prototype),o},c.apply(null,arguments)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}e.r(t),e.d(t,{addEventListeners:()=>E,evaluateExpression:()=>s,findNextTemplateExpression:()=>d,init:()=>w,loadTree:()=>h,removeEventListeners:()=>O,render:()=>p,variable:()=>j});var f=function(e,t){var n="return (state) => {".concat(Object.keys(t).map((function(e){return"const ".concat(e,' = state["').concat(e,'"];')})).join("\n"),"; return ").concat(e,"}");return Function(n)()};function s(e,t){try{var n=f(e,t)(t);return Array.isArray(n)&&(n=n.join("")),n}catch(t){throw new Error("Failed to create function from expression {{".concat(e,"}}: ").concat(t.message))}}function d(e){for(var t=e.indexOf("{{"),n=0,r=t;r<e.length;r++)if("{{"===e.slice(r,r+2)?(n++,r++):"}}"===e.slice(r,r+2)&&(n--,r++),0===n)return{start:t,end:r};return{start:t,end:-1}}var p=function(e,t){for(var n=0;n<e.length;n++){for(var r=e[n],o=r.element,i="",c=r.template,a=!0;a;){var u=d(c),l=u.start,f=u.end;if(-1===f){a=!1;break}var p=c.slice(l+2,f-1),h=c.slice(0,l),b=c.slice(f+1),E=s(v(p),t);i+="".concat(h).concat(E),c=b}var O=y(o,i+=c);O.length>0&&O.map((function(e){var n=e.element,r=e.content;g(n),n.innerHTML=r,m(n,t)}))}};function v(e){var t=document.createElement("div");return t.innerHTML=function(e){return e.replace(/<(?=[^<>]*>)/g,"&lt;").replace(/(?<=[^<>]*)>/g,"&gt;")}(e),t.textContent||t.innerText||""}function y(e,t){var n=e.cloneNode();return n.innerHTML=t,function e(t,n){for(var r=!1,o=0;o<t.childNodes.length;o++){var i=t.childNodes[o],c=n.childNodes[o];if(i.nodeType===Node.TEXT_NODE&&c&&c.nodeType===Node.TEXT_NODE&&i.textContent!==c.textContent){r=!0;break}}if(r)return[{element:t,content:n.innerHTML}];for(var a=[],u=0;u<t.childNodes.length;u++){var l=e(t.childNodes[u],n.childNodes[u]);a=a.concat(l)}return a}(e,n)}var h=function(e){for(var t=[],n=document.evaluate(".//*[text()[contains(., '{{')] and text()[contains(., '}}')]]",e,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=n.iterateNext();r;)t.push({element:r,template:r.innerHTML}),r=n.iterateNext();return t},b=function(e){for(var t=[],n=document.evaluate("template",e,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=n.iterateNext();r;)t.push(r),r=n.iterateNext();return t};function m(e,t){E(e,"click",t),E(e,"change",t)}function g(e){O(e,"click"),O(e,"change")}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click",n=arguments.length>2?arguments[2]:void 0;e.querySelectorAll("[data-on-".concat(t,"]")).forEach((function(e){var r=T(t,e,n);e.addEventListener(t,r),e["".concat(t,"Handler")]=r}))}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click";null==e||e.querySelectorAll("[data-on-".concat(t,"]")).forEach((function(e){var n=e["".concat(t,"Handler")];n&&e.removeEventListener(t,n)}))}var T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"click",t=arguments.length>2?arguments[2]:void 0,n=(arguments.length>1?arguments[1]:void 0).getAttribute("data-on-".concat(e));if(!n)throw new Error("Missing data-handler attribute");var r=f(n,t);return function(o){try{r(t),o.preventDefault()}catch(o){throw new Error("".concat(o.message,": data-on-").concat(e,"=").concat(n))}}},w=function(e){var t={},n=[];function c(e,n){var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(f,e);var i,c,a,l=o(f);function f(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),l.apply(this,arguments)}return i=f,(c=[{key:"connectedCallback",value:function(){for(var e=Object.keys(this.dataset),r=0;r<e.length;r++){var o=e[r],i=this.dataset[o];t[o]=i}this.outerHTML=n.replace(/\{\{\s*children\s*\}\}/g,this.innerHTML)}}])&&r(i.prototype,c),a&&r(i,a),Object.defineProperty(i,"prototype",{writable:!1}),f}(i(HTMLElement));customElements.define(e,c)}var a={element:null,get value(){if(this.element||(this.element=e.querySelector("#app")),!this.element)throw new Error("No app element found!");return this.element}};function l(e,r){setTimeout((function(){t[e]=r,p(n,t)}),0)}var f=function(){(function(e){e.forEach((function(e){var t=e.getAttribute("id");if(!t)throw new Error("Missing id attribute");c(t,e.innerHTML)}))})(b(a.value)),n=h(a.value),m(a.value,t),p(n,t)},s=e.onLoadHandler;return s&&e.removeEventListener("DOMContentLoaded",s),e.addEventListener("DOMContentLoaded",f),e.onLoadHandler=f,{variable:function(e,n){return t[e]=n,{set value(t){l(e,t)},get value(){return t[e]},set:function(t){l(e,t)}}}}},j=w(document).variable;return t})()));