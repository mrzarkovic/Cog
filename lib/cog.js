!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Cog=t():e.Cog=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{addEventListeners:()=>f,evaluateExpression:()=>r,findNextTemplateExpression:()=>o,init:()=>h,loadTree:()=>l,removeEventListeners:()=>v,render:()=>a,variable:()=>m});var n=function(e,t){var n="return (state) => {".concat(Object.keys(t).map((function(e){return"const ".concat(e,' = state["').concat(e,'"];')})).join("\n"),"; return ").concat(e,"}");return Function(n)()};function r(e,t){try{var r=n(e,t)(t);return Array.isArray(r)&&(r=r.join("")),r}catch(t){throw new Error("Failed to create function from expression {{".concat(e,"}}: ").concat(t.message))}}function o(e){for(var t=e.indexOf("{{"),n=0,r=t;r<e.length;r++)if("{{"===e.slice(r,r+2)?(n++,r++):"}}"===e.slice(r,r+2)&&(n--,r++),0===n)return{start:t,end:r};return{start:t,end:-1}}var a=function(e,t){for(var n=0;n<e.length;n++){for(var a=e[n],l=a.element,f="",v=a.template,s=!0;s;){var h=o(v),m=h.start,p=h.end;if(-1===p){s=!1;break}var g=v.slice(m+2,p-1),E=v.slice(0,m),y=v.slice(p+1),T=r(c(g),t);f+="".concat(E).concat(T),v=y}var b=i(l,f+=v);b.length>0&&b.map((function(e){var n=e.element,r=e.content;d(n),n.innerHTML=r,u(n,t)}))}};function c(e){var t=document.createElement("div");return t.innerHTML=function(e){return e.replace(/<(?=[^<>]*>)/g,"&lt;").replace(/(?<=[^<>]*)>/g,"&gt;")}(e),t.textContent||t.innerText||""}function i(e,t){var n=e.cloneNode();return n.innerHTML=t,function e(t,n){for(var r=!1,o=0;o<t.childNodes.length;o++){var a=t.childNodes[o],c=n.childNodes[o];if(a.nodeType===Node.TEXT_NODE&&c&&c.nodeType===Node.TEXT_NODE&&a.textContent!==c.textContent){r=!0;break}}if(r)return[{element:t,content:n.innerHTML}];for(var i=[],l=0;l<t.childNodes.length;l++){var u=e(t.childNodes[l],n.childNodes[l]);i=i.concat(u)}return i}(e,n)}var l=function(e){for(var t=[],n=document.evaluate(".//*[text()[contains(., '{{')] and text()[contains(., '}}')]]",e,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=n.iterateNext();r;)t.push({element:r,template:r.innerHTML}),r=n.iterateNext();return t};function u(e,t){f(e,"click",t),f(e,"change",t)}function d(e){v(e,"click"),v(e,"change")}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click",n=arguments.length>2?arguments[2]:void 0;e.querySelectorAll("[data-on-".concat(t,"]")).forEach((function(e){var r=s(t,e,n);e.addEventListener(t,r),e["".concat(t,"Handler")]=r}))}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click";null==e||e.querySelectorAll("[data-on-".concat(t,"]")).forEach((function(e){var n=e["".concat(t,"Handler")];n&&e.removeEventListener(t,n)}))}var s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"click",t=arguments.length>2?arguments[2]:void 0,r=(arguments.length>1?arguments[1]:void 0).getAttribute("data-on-".concat(e));if(!r)throw new Error("Missing data-handler attribute");var o=n(r,t);return function(n){try{o(t),n.preventDefault()}catch(n){throw new Error("".concat(n.message,": data-on-").concat(e,"=").concat(r))}}},h=function(e){var t={},n=[],r={element:null,get value(){if(this.element||(this.element=e.querySelector("#app")),!this.element)throw new Error("No app element found!");return this.element}};var o=function(){n=l(r.value),u(r.value,t),a(n,t)},c=e.onLoadHandler;return c&&e.removeEventListener("DOMContentLoaded",c),e.addEventListener("DOMContentLoaded",o),e.onLoadHandler=o,{variable:function(e,r){return t[e]=r,{set value(r){!function(e,r){setTimeout((function(){t[e]=r,a(n,t)}),0)}(e,r)},get value(){return t[e]}}}}},m=h(document).variable;return t})()));