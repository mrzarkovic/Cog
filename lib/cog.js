(()=>{"use strict";var e=function(e,t){var n="return (state) => {".concat(Object.keys(t).map((function(e){return"const ".concat(e,' = state["').concat(e,'"];')})).join("\n"),"; return ").concat(e,"}");return Function(n)()};function t(t,n){try{var r,o=e(t,n)(n);return Array.isArray(o)&&(o=o.join("")),null!==(r=o)&&void 0!==r?r:t}catch(e){if(e instanceof Error)throw new Error("Failed to create function from expression {{".concat(t,"}}: ").concat(e.message));return t}}function n(e){for(var t=e.indexOf("{{"),n=0,r=t;r<e.length;r++)if("{{"===e.slice(r,r+2)?(n++,r++):"}}"===e.slice(r,r+2)&&(n--,r++),0===n)return{start:t,end:r};return{start:t,end:-1}}var r=function(e,r){for(var c=0;c<e.length;c++){for(var u=e[c],d=u.element,f="",v=u.template,s=!0;s;){var h=n(v),m=h.start,g=h.end;if(-1===m||-1===g||m>=g){s=!1;break}var E=v.slice(m+2,g-1),p=v.slice(0,m),y=v.slice(g+1),T=t(o(E),r);f+="".concat(p).concat(T),v=y}var N=a(d,f+=v);N.length>0&&N.map((function(e){var t=e.element,n=e.content;l(t),t.innerHTML=null!=n?n:"",i(t,r)}))}};function o(e){var t=document.createElement("div");return t.innerHTML=function(e){return e.replace(/<(?=[^<>]*>)/g,"&lt;").replace(/(?<=[^<>]*)>/g,"&gt;")}(e),t.textContent||t.innerText||""}function a(e,t){var n=e.cloneNode();return n.innerHTML=t,function e(t,n){if(t.nodeType===Node.ELEMENT_NODE&&n.nodeType===Node.ELEMENT_NODE){for(var r=!1,o=0;o<t.childNodes.length;o++){var a=t.childNodes[o],c=n.childNodes[o];if(a.nodeType===Node.TEXT_NODE&&c&&c.nodeType===Node.TEXT_NODE&&a.textContent!==c.textContent){r=!0;break}}if(r)return[{element:t,content:n.innerHTML}];if(t.attributes.toString()!==n.attributes.toString())return[{element:t,content:n.innerHTML}];for(var i=[],l=0;l<t.childNodes.length;l++){var u=e(t.childNodes[l],n.childNodes[l]);i=i.concat(u)}return i}return[]}(e,n)}var c=function(e){for(var t=[],n=document.evaluate(".//*[text()[contains(., '{{')] and text()[contains(., '}}')]]",e,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=n.iterateNext();r;)t.push({element:r,template:r.innerHTML}),r=n.iterateNext();return t};function i(e,t){u(e,"click",t),u(e,"change",t)}function l(e){d(e,"click"),d(e,"change")}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click",n=arguments.length>2?arguments[2]:void 0;e.querySelectorAll("[data-on=".concat(t,"]")).forEach((function(e){var r=f(t,e,n);e.addEventListener(t,r),e["".concat(t,"Handler")]=r}))}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click";null==e||e.querySelectorAll("[data-on=".concat(t,"]")).forEach((function(e){var n=e["".concat(t,"Handler")];n&&e.removeEventListener(t,n)}))}var f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"click",n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return function(o){var a=n.getAttribute("data-handler");if(a)try{e(a,r)(r)}catch(o){if(o instanceof Error)throw new Error("".concat(o.message,": data-on=").concat(t," data-handler=").concat(a))}o.preventDefault()}},v=function(e){var t={},n=[],o={element:null,get value(){if(this.element||(this.element=e.querySelector("#app")),!this.element)throw new Error("No app element found!");return this.element}};var a=function(){n=c(o.value),i(o.value,t),r(n,t)},l=e.onLoadHandler;return l&&e.removeEventListener("DOMContentLoaded",l),e.addEventListener("DOMContentLoaded",a),e.onLoadHandler=a,{variable:function(e,o){return t[e]=o,{set:function(o){!function(e,o){setTimeout((function(){t[e]=o,r(n,t)}),0)}(e,o)},get value(){return t[e]}}}}}(document).variable;function s(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=v("todos",[{text:"hello",done:!1}]);v("test","hello world"),v("save",(function(){var e=document.querySelector("[data-input=todo");null!=e&&e.value&&(m.set([].concat(s(m.value),[{text:e.value,done:!1}])),e.value="")}));var g=v("counter",0);v("increment",(function(){g.set(g.value+1)})),v("toggleTodo",(function(e){var t=s(m.value);t[e].done=!t[e].done,m.set(t)})),v("Checkbox",(function(e){var t=e.index,n=void 0===t?-1:t,r=e.checked,o=void 0!==r&&r;return'<input type="checkbox" id="todo'.concat(n,'" data-on="change" data-handler="toggleTodo(').concat(n,')" ').concat(o?"checked":""," />")}))})();