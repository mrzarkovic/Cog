!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["ts-module-todo"]=e():t["ts-module-todo"]=e()}(self,(()=>(()=>{"use strict";var t={r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(i=o.key,c=void 0,c=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===n(c)?c:String(c)),o)}var i,c}function o(t){var e=a();return function(){var r,o=l(t);if(e){var i=l(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function i(t){var e="function"==typeof Map?new Map:void 0;return i=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return c(t,arguments,l(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),u(n,t)},i(t)}function c(t,e,n){return c=a()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&u(o,n.prototype),o},c.apply(null,arguments)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}t.r(e);var f=function(t,e){var n="return (state) => {".concat(Object.keys(e).map((function(t){return"const ".concat(t,' = state["').concat(t,'"];')})).join("\n"),"; return ").concat(t,"}");return Function(n)()};function s(t,e){try{var n=f(t,e)(e);return Array.isArray(n)&&(n=n.join("")),n}catch(e){throw new Error("Failed to create function from expression {{".concat(t,"}}: ").concat(e.message))}}function d(t){for(var e=t.indexOf("{{"),n=0,r=e;r<t.length;r++)if("{{"===t.slice(r,r+2)?(n++,r++):"}}"===t.slice(r,r+2)&&(n--,r++),0===n)return{start:e,end:r};return{start:e,end:-1}}var v=function(t,e){for(var n=0;n<t.length;n++){for(var r=t[n],o=r.element,i="",c=r.template,a=!0;a;){var u=d(c),l=u.start,f=u.end;if(-1===f){a=!1;break}var v=c.slice(l+2,f-1),h=c.slice(0,l),b=c.slice(f+1),E=s(p(v),e);i+="".concat(h).concat(E),c=b}var O=y(o,i+=c);O.length>0&&O.map((function(t){var n=t.element,r=t.content;g(n),n.innerHTML=r,m(n,e)}))}};function p(t){var e=document.createElement("div");return e.innerHTML=function(t){return t.replace(/<(?=[^<>]*>)/g,"&lt;").replace(/(?<=[^<>]*)>/g,"&gt;")}(t),e.textContent||e.innerText||""}function y(t,e){var n=t.cloneNode();return n.innerHTML=e,function t(e,n){for(var r=!1,o=0;o<e.childNodes.length;o++){var i=e.childNodes[o],c=n.childNodes[o];if(i.nodeType===Node.TEXT_NODE&&c&&c.nodeType===Node.TEXT_NODE&&i.textContent!==c.textContent){r=!0;break}}if(r)return[{element:e,content:n.innerHTML}];for(var a=[],u=0;u<e.childNodes.length;u++){var l=t(e.childNodes[u],n.childNodes[u]);a=a.concat(l)}return a}(t,n)}var h=function(t){for(var e=[],n=document.evaluate(".//*[text()[contains(., '{{')] and text()[contains(., '}}')]]",t,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=n.iterateNext();r;)e.push({element:r,template:r.innerHTML}),r=n.iterateNext();return e},b=function(t){for(var e=[],n=document.evaluate("template",t,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=n.iterateNext();r;)e.push(r),r=n.iterateNext();return e};function m(t,e){E(t,"click",e),E(t,"change",e)}function g(t){O(t,"click"),O(t,"change")}function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click",n=arguments.length>2?arguments[2]:void 0;t.querySelectorAll("[data-on-".concat(e,"]")).forEach((function(t){var r=T(e,t,n);t.addEventListener(e,r),t["".concat(e,"Handler")]=r}))}function O(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click";null==t||t.querySelectorAll("[data-on-".concat(e,"]")).forEach((function(t){var n=t["".concat(e,"Handler")];n&&t.removeEventListener(e,n)}))}var T=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"click",e=arguments.length>2?arguments[2]:void 0,n=(arguments.length>1?arguments[1]:void 0).getAttribute("data-on-".concat(t));if(!n)throw new Error("Missing data-handler attribute");var r=f(n,e);return function(o){try{r(e),o.preventDefault()}catch(o){throw new Error("".concat(o.message,": data-on-").concat(t,"=").concat(n))}}},w=function(t){var e={},n=[];function c(t,n){var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}(f,t);var i,c,a,l=o(f);function f(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),l.apply(this,arguments)}return i=f,(c=[{key:"connectedCallback",value:function(){for(var t=Object.keys(this.dataset),r=0;r<t.length;r++){var o=t[r],i=this.dataset[o];e[o]=i}this.outerHTML=n.replace(/\{\{\s*children\s*\}\}/g,this.innerHTML)}}])&&r(i.prototype,c),a&&r(i,a),Object.defineProperty(i,"prototype",{writable:!1}),f}(i(HTMLElement));customElements.define(t,c)}var a={element:null,get value(){if(this.element||(this.element=t.querySelector("#app")),!this.element)throw new Error("No app element found!");return this.element}};function l(t,r){setTimeout((function(){e[t]=r,v(n,e)}),0)}var f=function(){(function(t){t.forEach((function(t){var e=t.getAttribute("id");if(!e)throw new Error("Missing id attribute");c(e,t.innerHTML)}))})(b(a.value)),n=h(a.value),m(a.value,e),v(n,e)},s=t.onLoadHandler;return s&&t.removeEventListener("DOMContentLoaded",s),t.addEventListener("DOMContentLoaded",f),t.onLoadHandler=f,{variable:function(t,n){return e[t]=n,{set value(e){l(t,e)},get value(){return e[t]},set:function(e){l(t,e)}}}}}(document).variable;function j(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var S=w("todos",[{text:"hello",done:!1}]);w("save",(function(){var t=document.querySelector("[data-input=todo");null!=t&&t.value&&(S.set([].concat(j(S.value),[{text:t.value,done:!1}])),t.value="")})),w("toggleTodo",(function(t){var e=j(S.value);e[t].done=!e[t].done,S.set(e)})),w("Checkbox",(function(t){var e=t.index,n=void 0===e?-1:e,r=t.checked,o=void 0!==r&&r;return'<input type="checkbox" id="todo'.concat(n,'" data-on-change="toggleTodo(').concat(n,')" ').concat(o?"checked":""," />")}));var N=w("counter",0);return w("increment",(function(){N.set(N.value+1)})),e})()));